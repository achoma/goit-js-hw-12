{"version":3,"file":"index.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst API_KEY = '42580380-f7e9d56cf0d50abf8107b2707';\nconst API_URL = 'https://pixabay.com/api/';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  const form = document.getElementById('search-form');\n  const gallery = document.getElementById('gallery');\n  const loader = document.getElementById('loader');\n  const loadMoreButton = document.getElementById('load-more');\n\n  // Check if elements exist\n  if (!form || !gallery || !loader || !loadMoreButton) {\n    console.error('One or more elements are missing in the DOM.');\n    return; // Stop execution if elements are not found\n  }\n\n  let lightbox;\n  let currentPage = 1;\n  let currentQuery = '';\n  let totalHits = 0;\n\n  form.addEventListener('submit', async e => {\n    e.preventDefault();\n    currentQuery = document.getElementById('query').value.trim();\n\n    if (currentQuery === '') return;\n\n    clearGallery();\n    toggleLoader(true);\n    loadMoreButton.classList.add('hidden');\n    currentPage = 1;\n\n    try {\n      const response = await fetchImages(currentQuery, currentPage);\n      const images = response.hits;\n      totalHits = response.totalHits;\n\n      if (images.length === 0) {\n        showErrorMessage(\n          'Sorry, there are no images matching your search query. Please try again!'\n        );\n        return;\n      }\n\n      renderGallery(images);\n      lightbox = new SimpleLightbox('#gallery a');\n\n      if (images.length < totalHits) {\n        loadMoreButton.classList.remove('hidden');\n      }\n    } catch (error) {\n      handleFetchError(error);\n    } finally {\n      toggleLoader(false);\n    }\n  });\n\n  loadMoreButton.addEventListener('click', async () => {\n    currentPage += 1;\n    toggleLoader(true);\n\n    try {\n      const response = await fetchImages(currentQuery, currentPage);\n      const images = response.hits;\n\n      renderGallery(images);\n      lightbox.refresh();\n\n      smoothScroll();\n\n      if (currentPage * 40 >= totalHits) {\n        loadMoreButton.classList.add('hidden');\n        showErrorMessage(\n          \"We're sorry, but you've reached the end of search results.\"\n        );\n      }\n    } catch (error) {\n      handleFetchError(error);\n    } finally {\n      toggleLoader(false);\n    }\n  });\n\n  async function fetchImages(query, page) {\n    const url = `${API_URL}?key=${API_KEY}&q=${encodeURIComponent(\n      query\n    )}&image_type=photo&orientation=horizontal&safesearch=true&per_page=40&page=${page}`;\n    const response = await axios.get(url);\n    return response.data;\n  }\n\n  function handleFetchError(error) {\n    if (error.response && error.response.status !== 200) {\n      showErrorMessage(\n        'There was a problem with the network connection. Please try again later.'\n      );\n    } else {\n      showErrorMessage('An unexpected error occurred. Please try again.');\n    }\n  }\n\n  function showErrorMessage(message) {\n    iziToast.error({\n      title: 'Error',\n      message: message,\n    });\n  }\n\n  function renderGallery(images) {\n    const markup = images\n      .map(\n        ({\n          webformatURL,\n          largeImageURL,\n          tags,\n          likes,\n          views,\n          comments,\n          downloads,\n        }) => {\n          return `\n          <div class=\"gallery-item\">\n            <a href=\"${largeImageURL}\">\n              <img src=\"${webformatURL}\" alt=\"${tags}\" />\n            </a>\n            <div class=\"info\">\n              <p>Likes: ${likes}</p>\n              <p>Views: ${views}</p>\n              <p>Comments: ${comments}</p>\n              <p>Downloads: ${downloads}</p>\n            </div>\n          </div>`;\n        }\n      )\n      .join('');\n    gallery.insertAdjacentHTML('beforeend', markup);\n  }\n\n  function clearGallery() {\n    gallery.innerHTML = '';\n  }\n\n  function toggleLoader(visible) {\n    if (loader) {\n      loader.classList.toggle('hidden', !visible);\n    }\n  }\n\n  function smoothScroll() {\n    const { height: cardHeight } = document\n      .querySelector('.gallery-item')\n      .getBoundingClientRect();\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n  }\n});\n"],"names":["API_KEY","API_URL","form","gallery","loader","loadMoreButton","lightbox","currentPage","currentQuery","totalHits","e","clearGallery","toggleLoader","response","fetchImages","images","showErrorMessage","renderGallery","SimpleLightbox","error","handleFetchError","smoothScroll","query","page","url","axios","message","iziToast","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","visible","cardHeight"],"mappings":"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"}