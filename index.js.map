{"version":3,"file":"index.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst API_KEY = '42580380-f7e9d56cf0d50abf8107b2707';\nconst API_URL = 'https://pixabay.com/api/';\nconst form = document.getElementById('search-form');\nconst gallery = document.getElementById('gallery');\nconst loader = document.getElementById('loader');\nconst loadMoreButton = document.getElementById('load-more');\nlet lightbox;\nlet currentPage = 1;\nlet currentQuery = '';\nlet totalHits = 0;\n\nform.addEventListener('submit', async e => {\n  e.preventDefault();\n  currentQuery = document.getElementById('query').value.trim();\n\n  if (currentQuery === '') return;\n\n  clearGallery();\n  toggleLoader(true);\n  loadMoreButton.classList.add('hidden');\n  currentPage = 1;\n\n  try {\n    const response = await fetchImages(currentQuery, currentPage);\n    const images = response.hits;\n    totalHits = response.totalHits;\n\n    if (images.length === 0) {\n      showErrorMessage(\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n      return;\n    }\n\n    renderGallery(images);\n    lightbox = new SimpleLightbox('#gallery a');\n\n    if (images.length < totalHits) {\n      loadMoreButton.classList.remove('hidden');\n    }\n  } catch (error) {\n    handleFetchError(error);\n  } finally {\n    toggleLoader(false);\n  }\n});\n\nloadMoreButton.addEventListener('click', async () => {\n  currentPage += 1;\n  toggleLoader(true);\n\n  try {\n    const response = await fetchImages(currentQuery, currentPage);\n    const images = response.hits;\n\n    renderGallery(images);\n    lightbox.refresh();\n\n    smoothScroll();\n\n    if (currentPage * 40 >= totalHits) {\n      loadMoreButton.classList.add('hidden');\n      showErrorMessage(\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n    }\n  } catch (error) {\n    handleFetchError(error);\n  } finally {\n    toggleLoader(false);\n  }\n});\n\nasync function fetchImages(query, page) {\n  const url = `${API_URL}?key=${API_KEY}&q=${encodeURIComponent(\n    query\n  )}&image_type=photo&orientation=horizontal&safesearch=true&per_page=40&page=${page}`;\n  const response = await axios.get(url);\n  return response.data;\n}\n\nfunction handleFetchError(error) {\n  if (error.response && error.response.status !== 200) {\n    showErrorMessage(\n      'There was a problem with the network connection. Please try again later.'\n    );\n  } else {\n    showErrorMessage('An unexpected error occurred. Please try again.');\n  }\n}\n\nfunction showErrorMessage(message) {\n  iziToast.error({\n    title: 'Error',\n    message: message,\n  });\n}\n\nfunction renderGallery(images) {\n  const markup = images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `\n        <div class=\"gallery-item\">\n          <a href=\"${largeImageURL}\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" />\n          </a>\n          <div class=\"info\">\n            <p>Likes: ${likes}</p>\n            <p>Views: ${views}</p>\n            <p>Comments: ${comments}</p>\n            <p>Downloads: ${downloads}</p>\n          </div>\n        </div>`;\n      }\n    )\n    .join('');\n  gallery.insertAdjacentHTML('beforeend', markup);\n}\n\nfunction clearGallery() {\n  gallery.innerHTML = '';\n}\n\nfunction toggleLoader(visible) {\n  loader.classList.toggle('hidden', !visible);\n}\n\nfunction smoothScroll() {\n  const { height: cardHeight } = document\n    .querySelector('.gallery-item')\n    .getBoundingClientRect();\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["API_KEY","API_URL","form","gallery","loader","loadMoreButton","lightbox","currentPage","currentQuery","totalHits","clearGallery","toggleLoader","response","fetchImages","images","showErrorMessage","renderGallery","SimpleLightbox","error","handleFetchError","smoothScroll","query","page","url","axios","message","iziToast","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","visible","cardHeight"],"mappings":"wyBAOA,MAAMA,EAAU,qCACVC,EAAU,2BACVC,EAAO,SAAS,eAAe,aAAa,EAC5CC,EAAU,SAAS,eAAe,SAAS,EAC3CC,EAAS,SAAS,eAAe,QAAQ,EACzCC,EAAiB,SAAS,eAAe,WAAW,EAC1D,IAAIC,EACAC,EAAc,EACdC,EAAe,GACfC,EAAY,EAEhBP,EAAK,iBAAiB,SAAU,MAAM,GAAK,CAIzC,GAHA,EAAE,eAAc,EAChBM,EAAe,SAAS,eAAe,OAAO,EAAE,MAAM,OAElDA,IAAiB,GAErB,CAAAE,IACAC,EAAa,EAAI,EACjBN,EAAe,UAAU,IAAI,QAAQ,EACrCE,EAAc,EAEd,GAAI,CACF,MAAMK,EAAW,MAAMC,EAAYL,EAAcD,CAAW,EACtDO,EAASF,EAAS,KAGxB,GAFAH,EAAYG,EAAS,UAEjBE,EAAO,SAAW,EAAG,CACvBC,EACE,0EACR,EACM,MACD,CAEDC,EAAcF,CAAM,EACpBR,EAAW,IAAIW,EAAe,YAAY,EAEtCH,EAAO,OAASL,GAClBJ,EAAe,UAAU,OAAO,QAAQ,CAE3C,OAAQa,EAAO,CACdC,EAAiBD,CAAK,CAC1B,QAAY,CACRP,EAAa,EAAK,CACnB,EACH,CAAC,EAEDN,EAAe,iBAAiB,QAAS,SAAY,CACnDE,GAAe,EACfI,EAAa,EAAI,EAEjB,GAAI,CAEF,MAAMG,GADW,MAAMD,EAAYL,EAAcD,CAAW,GACpC,KAExBS,EAAcF,CAAM,EACpBR,EAAS,QAAO,EAEhBc,IAEIb,EAAc,IAAME,IACtBJ,EAAe,UAAU,IAAI,QAAQ,EACrCU,EACE,4DACR,EAEG,OAAQG,EAAO,CACdC,EAAiBD,CAAK,CAC1B,QAAY,CACRP,EAAa,EAAK,CACnB,CACH,CAAC,EAED,eAAeE,EAAYQ,EAAOC,EAAM,CACtC,MAAMC,EAAM,GAAGtB,CAAO,QAAQD,CAAO,MAAM,mBACzCqB,CACJ,CAAG,6EAA6EC,CAAI,GAElF,OADiB,MAAME,EAAM,IAAID,CAAG,GACpB,IAClB,CAEA,SAASJ,EAAiBD,EAAO,CAC3BA,EAAM,UAAYA,EAAM,SAAS,SAAW,IAC9CH,EACE,0EACN,EAEIA,EAAiB,iDAAiD,CAEtE,CAEA,SAASA,EAAiBU,EAAS,CACjCC,EAAS,MAAM,CACb,MAAO,QACP,QAASD,CACb,CAAG,CACH,CAEA,SAAST,EAAcF,EAAQ,CAC7B,MAAMa,EAASb,EACZ,IACC,CAAC,CACC,aAAAc,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IACe;AAAA;AAAA,qBAEML,CAAa;AAAA,wBACVD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA,wBAG1BC,CAAK;AAAA,wBACLC,CAAK;AAAA,2BACFC,CAAQ;AAAA,4BACPC,CAAS;AAAA;AAAA,eAIhC,EACA,KAAK,EAAE,EACV/B,EAAQ,mBAAmB,YAAawB,CAAM,CAChD,CAEA,SAASjB,GAAe,CACtBP,EAAQ,UAAY,EACtB,CAEA,SAASQ,EAAawB,EAAS,CAC7B/B,EAAO,UAAU,OAAO,SAAU,CAAC+B,CAAO,CAC5C,CAEA,SAASf,GAAe,CACtB,KAAM,CAAE,OAAQgB,CAAU,EAAK,SAC5B,cAAc,eAAe,EAC7B,wBACH,OAAO,SAAS,CACd,IAAKA,EAAa,EAClB,SAAU,QACd,CAAG,CACH"}